<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printable Menu - Artevia Palette</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-brand { background-color: #a43c1a; }
        .text-brand { color: #a43c1a; }
        .border-brand { border-color: #a43c1a; }

        @media print {
            .non-printable { display: none !important; }
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .printable-menu-page {
                page-break-after: always;
                box-shadow: none !important;
                border: none !important;
                height: 100vh;
            }
            .bg-brand { background-color: #a43c1a !important; }
        }
        
        /* A4 aspect ratio for screen view */
        .a4-aspect {
            width: 210mm;
            min-height: 297mm;
        }
    </style>
</head>
<body class="bg-gray-200 font-serif">

    <div class="container mx-auto my-8">
        <!-- Print Button Container -->
        <div id="print-button-container" class="text-center mb-4 non-printable">
            <button onclick="window.print()" class="bg-brand text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-90 transition">
                Print Menu
            </button>
        </div>

        <div id="menu-container" class="space-y-8">
            <!-- Page 1 -->
            <div class="printable-menu-page bg-white max-w-3xl mx-auto shadow-lg a4-aspect">
                <header class="text-center p-8 bg-brand">
                    <img src="https://raw.githubusercontent.com/Sarup098/artevia/main/Artevia_Palette_Logo.png" alt="Artevia Palette Logo" class="h-40 w-auto mx-auto">
                </header>
                <div id="menu-page-1" class="p-12">
                     <p class="text-center text-gray-500">Loading Page 1...</p>
                </div>
            </div>
            <!-- Page 2 -->
            <div class="printable-menu-page bg-white max-w-3xl mx-auto shadow-lg a4-aspect">
                 <header class="text-center p-8 bg-brand">
                    <img src="https://raw.githubusercontent.com/Sarup098/artevia/main/Artevia_Palette_Logo.png" alt="Artevia Palette Logo" class="h-40 w-auto mx-auto">
                </header>
                <div id="menu-page-2" class="p-12">
                     <p class="text-center text-gray-500">Loading Page 2...</p>
                </div>
            </div>
            <!-- Page 3 -->
            <div class="printable-menu-page bg-white max-w-3xl mx-auto shadow-lg a4-aspect">
                 <header class="text-center p-8 bg-brand">
                    <img src="https://raw.githubusercontent.com/Sarup098/artevia/main/Artevia_Palette_Logo.png" alt="Artevia Palette Logo" class="h-40 w-auto mx-auto">
                </header>
                <div id="menu-page-3" class="p-12">
                     <p class="text-center text-gray-500">Loading Page 3...</p>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
        import { getFirestore, collection, getDocs, query } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCuepnUYt_rDEffSraYycHxYrm5sDlXM6s",
            authDomain: "palette-orders.firebaseapp.com",
            projectId: "palette-orders",
            storageBucket: "palette-orders.firebasestorage.app",
            messagingSenderId: "424044050877",
            appId: "1:424044050877:web:9ea875314de19b70173ad4",
            measurementId: "G-XNVCLD42Y4"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function fetchAndRenderMenu() {
            const menuPage1 = document.getElementById('menu-page-1');
            const menuPage2 = document.getElementById('menu-page-2');
            const menuPage3 = document.getElementById('menu-page-3');
            
            try {
                const q = query(collection(db, "menu"));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    menuPage1.innerHTML = '<p class="text-center text-gray-500">No menu items found.</p>';
                    return;
                }
                
                const allItems = [];
                querySnapshot.forEach((doc) => allItems.push(doc.data()));

                const menuByCategory = allItems.reduce((acc, item) => {
                    const category = item.category || 'Uncategorized';
                    if (!acc[category]) acc[category] = [];
                    acc[category].push(item);
                    return acc;
                }, {});

                const sortedCategories = Object.keys(menuByCategory).sort();

                // Clear loading messages
                menuPage1.innerHTML = ''; 
                menuPage2.innerHTML = '';
                menuPage3.innerHTML = '';

                // Distribute categories across 3 pages
                const catsPerPage = Math.ceil(sortedCategories.length / 2); // 2 pages for items, 1 for specials
                const page1Categories = sortedCategories.slice(0, catsPerPage);
                const page2Categories = sortedCategories.slice(catsPerPage);

                const renderCategory = (category, items) => {
                    const section = document.createElement('section');
                    section.className = 'mb-8 menu-category';
                    
                    items.sort((a, b) => a.name.localeCompare(b.name));

                    let itemsHtml = '';
                    items.forEach(item => {
                        itemsHtml += `
                            <div class="py-2">
                                <div class="flex justify-between items-baseline">
                                    <h3 class="font-bold text-lg">${item.name}</h3>
                                    <p class="font-semibold text-lg text-right">â‚¹${item.price}</p>
                                </div>
                                <p class="text-sm text-gray-600">${item.description || ''}</p>
                            </div>
                        `;
                    });

                    section.innerHTML = `
                        <div class="flex items-center gap-6 mb-2">
                            <h2 class="text-3xl font-bold text-brand flex-shrink-0">${category}</h2>
                            <div class="w-full h-px bg-gray-200"></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 divide-y divide-gray-100">
                            ${itemsHtml}
                        </div>
                    `;
                    return section;
                };
                
                page1Categories.forEach(cat => menuPage1.appendChild(renderCategory(cat, menuByCategory[cat])));
                page2Categories.forEach(cat => menuPage2.appendChild(renderCategory(cat, menuByCategory[cat])));
                
                // Add Coming Soon section to the third page
                menuPage3.innerHTML = `
                    <section class="menu-category text-center">
                         <div class="flex items-center gap-6 mb-4">
                            <h2 class="text-3xl font-bold text-brand flex-shrink-0">Coming Soon</h2>
                            <div class="w-full h-px bg-gray-200"></div>
                        </div>
                        <div class="mt-8">
                            <h3 class="text-5xl font-bold text-gray-800">Matcha</h3>
                             <p class="text-gray-500 mt-2">Authentic Japanese green tea delights.</p>
                        </div>
                        <div class="my-8 text-2xl font-serif text-gray-400">&</div>
                        <div class="mb-8">
                            <h3 class="text-5xl font-bold text-gray-800">Boba Tea</h3>
                             <p class="text-gray-500 mt-2">Refreshing Taiwanese bubble tea creations.</p>
                        </div>
                    </section>
                `;


            } catch (error) {
                console.error("Error fetching menu:", error);
                menuPage1.innerHTML = '<p class="text-center text-red-500">Failed to load menu.</p>';
            }
        }

        window.onload = fetchAndRenderMenu;
    </script>

</body>
</html>

